const api=wp.customize,controlApi=parent.wp.customize;export class Preview{bindEvents(){$(()=>this._bindTypography())}getCSS(e,t="bgtfw_headings_typography"){var i,n,a,o,s,p;_.isUndefined(e)&&(e=api(t)()),p=(p=t.replace("bgtfw_","")).replace("_typography","");try{e=JSON.parse(e)}catch(e){}i=e.variant,n=i?parseInt(i):"initial",a=i?i.replace(n,""):"initial";let r="";if("bgtfw_headings_typography"===t){o=parseInt(api("bgtfw_headings_font_size")());let e=(s=(s=api("bgtfw_headings_font_size")().replace(o,""))||"px").match(/(em|ex|%|px|cm|mm|in|pt|pc|rem)/);s=e?e[0]:"px"}if(_.each(BOLDGRID.CUSTOMIZER.data.customizerOptions.typography.selectors,function(e,i){var d;"headings"===e.type&&"bgtfw_headings_typography"===t?(d=o*e.amount,"ceil"===e.round&&(d=Math.ceil(d)),"floor"===e.round&&(d=Math.floor(d)),n&&a?(r+=i+"{font-size:"+d+s+";",r+="font-style:"+a+";",r+="font-weight:"+n+";}"):n&&(r+=i+"{font-size:"+d+s+";",r+="font-weight:"+n+";}"),r+=i+"{font-size:"+d+s+";}"):p===e.type&&(n&&a?(r+=i+"{",r+="font-style:"+a+";",r+="font-weight:"+n+";}"):n?(r+=i+"{",r+="font-weight:"+n+";}"):a&&(r+=i+"{",r+="font-style:"+a+";}"))}),p.includes("menu")){let e=p.replace(/_/g,"-");e="#"+(e=e.replace("menu-",""))+"-menu li a",n&&a?(r+=e+"{",r+="font-style:"+a+";",r+="font-weight:"+n+";}"):n?(r+=e+"{",r+="font-weight:"+n+";}"):a&&(r+=e+"{",r+="font-style:"+a+";}")}return r}addStyle(e,t="bgtfw_headings_typography"){var i=t.replace(/_/g,"-");if(document.getElementById(i))document.getElementById(i).innerHTML=e;else{let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.id=i,n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}document.getElementById("kirki-postmessage-"+t)&&$("#"+i).insertAfter("#kirki-postmessage-"+t)}_bindTypography(){var e=[];controlApi.control.each(t=>{"kirki-typography"===t.params.type&&e.push(t.id)}),e.forEach(e=>this.addTypographyOverride(e)),e.forEach(e=>{api(e,t=>t.bind(t=>this.addStyle(this.getCSS(t,e),e)))}),api("bgtfw_headings_font_size",e=>e.bind(e=>this.addStyle(this.getCSS(e))))}addTypographyOverride(e){api(e,function(t){t.bind(function(t){var i,n,a;if(!_.isString(t))return;a=JSON.parse(t),/\s/.test(a["font-family"])&&(a["font-family"]='"'+a["font-family"]+'"'),kirkiPostMessageFields.forEach(function(t){!i&&e===t.id&&t.output[0].element&&(i=t.output[0].element)}),n=i+" {font-family: "+a["font-family"]+";}";let o=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",s.id=e+"-font-families",s.styleSheet?s.styleSheet.cssText=n:s.appendChild(document.createTextNode(n)),o.appendChild(s)})})}}