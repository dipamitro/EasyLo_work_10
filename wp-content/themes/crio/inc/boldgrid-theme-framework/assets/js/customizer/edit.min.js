var BOLDGRID=BOLDGRID||{};BOLDGRID.CustomizerEdit=BOLDGRID.CustomizerEdit||{};const{__:__}=wp.i18n;!function(t){"use strict";var e,o;o=parent.wp.customize,BOLDGRID.CustomizerEdit={buttonParams:window.boldgridFrameworkCustomizerEdit||{},buttonCollisionSet:{},targetHighlightTop:!0,userIsScrolling:!1,buttonHeight:0,buttonWidth:0,defaultZindex:200,init:function(){o.previewer.bind("ready",e._onLoad)},_onLoad:function(){e.destroy(),e.start(),wp.customize.selectiveRefresh.bind("partial-content-rendered",function(){e.destroy(),e.start()}),wp.customize("bgtfw_secondary_button_text_shadow",t=>{t.bind(()=>{e.destroy(),e.start()})}),wp.customize("bgtfw_primary_button_text_shadow",t=>{t.bind(()=>{e.destroy(),e.start()})}),o.control.each(t=>{var o=t.id;o&&o.includes("_title_")&&o.includes("container")&&wp.customize(o,t=>{t.bind(()=>{e.destroy(),e.start()})})})},destroy:function(){e.buttonCollisionSet=[],t(".bgtfw-multi-edit-button").remove(),t(".bgtfw-edit-border-box").remove(),t(".bgtfw-edit-button").remove()},start:function(){e.$targetHighlight=t("#target-highlight"),e.addButtons(),t(window).on("scroll",function(){0>=t(window).scrollTop()?t("#masthead-sticky").css("display","none"):o("bgtfw_fixed_header")&&o("bgtfw_fixed_header")()?t("#masthead-sticky").css("display","block"):t("#masthead-sticky").is('[class*="sticky-template"]')&&t("#masthead-sticky").css("display","block")})},addButtons:function(){t(".no-edit-button").removeClass("no-edit-button"),_(e.buttonParams.params).each(function(o,i){if(t(i).each(function(){var e=t(this).clone().children().remove().end().text();(0===t(this).height()||0===t(this).outerWidth()||t(this).is("h1, h2, h3, h4, h5, h6, p, a")&&0===e.length&&!t(this).is(".site-title, .entry-title, .custom-logo-link, .site-description"))&&t(this).addClass("no-edit-button")}),1===Object.keys(o).length){let n=Object.keys(o)[0],s=e.determineButtonPosition(i),a=[".button-primary",".button-secondary",".showcoupon",".avatar",".comment-edit-link",".bgc-single-title"].join(", "),d=[".page-title",".entry-title",".tags-links",".cat-links",".read-more",".author",".posted-on",".nav-previous",".nav-next",".logged-in-as",".comment-meta",".edit-link",".bgc-single-article"].join(", ");t(i).each(function(){("bgtfw_body_link_color"===n&&t(this).is(a)||"bgtfw_body_link_color"===n&&t(this).parent().is(d))&&t(this).addClass("no-"+n+"-edit-button"),("bgtfw_body_typography"===n&&t(this).is(".entry-title")||"bgtfw_body_typography"===n&&0!==t(this).siblings(".bg-hr").length)&&t(this).addClass("no-"+n+"-edit-button"),"bgtfw_headings_typography"===n&&t(this).is(".site-description, .site-title")&&t(this).addClass("no-"+n+"-edit-button")}),e.addSingleButton(i,n,o[n],s)}else{let t=e.determineButtonPosition(i);e.addMultiButtons(i,o,t)}}),e.addMenuButtons(),e.addWidgetButtons(),e.addExternalButtons(),_.defer(e.fixStaticPositioning),_.defer(e.fixCollisions),_.defer(e.fixZindex),t(":not(.bgtfw-multi-edit-button)").on("click",function(){t(".bgtfw-multi-edit-button.expanded").trigger("click")})},fixZindex:function(){var e=301;t(".sm").each(function(){e-=1,t(this).css("z-index",e)})},fixStaticPositioning:function(){t(".bgtfw-multi-edit-button, .bgtfw-edit-button").each(function(){"static"===t(this).parent().css("position")&&(t(this).parent().css("position","relative"),"bgtfw_body_link_color"===t(this).data("focus-id")&&"inline"===t(this).parent().css("display")&&t(this).parent().css("display","inline-block")),t(this).parent().hasClass("btn-longshadow")&&(t(this).parent().css("position","static"),t(this).parent().parent().css("position","relative"))})},sortButtonsAsc:function(e,o){var i=e.offset().top,n=o.offset().top;return i===n&&(i=t(e.parent()).offset().top,n=t(o.parent()).offset().top),i<n?-1:i>n?1:0},sortButtonsDesc:function(t,e){var o=t.offset().top,i=e.offset().top;return i<o?-1:i>o?1:0},assignCollisionSet:function(t,o){var i=Math.ceil(t.offset().top)>Math.ceil(o.offset().top)?t:o,n=t.is(i)?o:t,s=n.attr("data-collision-set");i.offset({top:Math.ceil(n.offset().top)+30,left:i.offset().left}),void 0===s&&(s=e.buttonCollisionSet,e.buttonCollisionSet++),i.attr("data-collision-set",s),n.attr("data-collision-set",s)},fixCollisions:function(){var o=[];e.buttonCollisionSet=1,t(".bgtfw-multi-edit-button:visible, .bgtfw-edit-button:visible").each(function(){o.push(t(this))}),o.sort(e.sortButtonsAsc),t.each(o,function(i,n){var s=t(n);i<o.length-1&&t.each(o,function(o,i){var n=t(i);s.is(n)||e.determineButtonCollision(s,n)&&e.assignCollisionSet(s,n)})})},fixMultiCollisions:function(e){var o=t(e).height(),i=t(e).parent().offset(),n=t("#colophon.site-footer").offset().top+t("#colophon.site-footer").outerHeight(!0),s=t(window).scrollTop(),a={};i&&(0>=i.top-s-30-o&&(a.top="30px",a.bottom="unset",t(e).css(a)),o+i.top+30>=n&&(a.top="unset",a.bottom="30px",t(e).css(a)))},adjustButtonPosition:function(t,e){var o=!!t.parent(".bgtfw-has-edit").is(".left-button"),i=t.offset().top,n=Math.floor(t.offset().left),s=30*e,a=o?n+s:n-s;t.offset({top:i,left:a})},determineButtonCollision:function(t,e){var o=t.get(0).getBoundingClientRect(),i=e.get(0).getBoundingClientRect();return!(o.right<i.left||o.left>i.right||o.bottom<i.top||o.top>i.bottom)},determineButtonPosition:function(e){var o=t(e).height(),i=t(e).offset(),n=t(document).height(),s={hor:"right",vert:"bottom"};return i&&30>i.left&&(s.hor="left"),i&&o>n-(o+i.top)&&(s.vert="top"),s},addWidgetButtons:function(){var o=t("aside.sidebar");_(o).each(function(t){var o=t.id,i="sidebar-widgets-"+o,n=e.determineButtonPosition("#"+o);e.addSingleButton("#"+o,i,{type:"section",label:__("Widget Area","bgtfw")},n)})},addExternalButtons:function(){var o,i=e.determineButtonPosition(".site-content .entry-content"),n=e.determineButtonPosition("#masthead.template-header");if(e.addSingleButton(".site-content .entry-content","editPostLink",{type:"external",label:"Edit Page / Post Content",description:"Edit the Content of this Page / Post",dialogSelector:"#entry-content"},i),0!==t("#masthead.template-header").length){let i=t("#masthead.template-header").get(0).classList;const s=/template-(\d+)/;i.forEach(function(t){let i=s.exec(t);i&&(o=i[1],e.buttonParams.pageHeaderLink=e.buttonParams.editPostLink.replace(/post=\d+/,"post="+o))}),e.addMultiButtons("#masthead.template-header",{bgtfw_page_headers:{type:"section",label:__("Change Custom Page Template","bgtfw"),description:__("Choose which custom page template to display","bgtfw")},pageHeaderLink:{type:"external",label:"Edit Custom Page Header",description:"Edit the Custom Page Header",dialogSelector:"#custom-page-header"}},n)}},addMenuButtons:function(){var i=t(".bgtfw-menu-wrap");_(i).each(function(t){var i,n,s,a=t.id.split("-wrap")[0],d={};if(_(o.section("menu_locations").controls()).each(function(t){t.themeLocation===a&&(i=t.setting(),n=t.params.label)}),i){let t="ul#"+a+"-menu";t=t.replace(/_(\d{3})/,"-$1"),d["nav_menu["+i+"]"]={type:"section",label:"Add Menu Items",description:"Add or remove items to this menu"},d["bgtfw_menu_location_"+a]={type:"panel",label:"Customize "+n,description:"Customize the styling of this menu"},s=e.determineButtonPosition(t),e.addMultiButtons(t,d,s)}else d["nav_menu_locations["+a+"]"]={type:"control",label:"Assign Menu",description:"Assign or Create a menu for this location"},d["bgtfw_menu_location_"+a]={type:"panel",label:"Customize "+n,description:"Customize the styling of this menu"},s=e.determineButtonPosition("div#"+a+"-wrap"),e.addMultiButtons("div#"+a+"-wrap",d,s)})},addMultiButtons:function(i,n,s){"static"===t(i).css("position")&&t(i).css("position","relative"),t(i).not(".no-edit-button").addClass("bgtfw-has-edit multi-edit-button"),t(i).not(".no-edit-button").addClass(s.vert+"-button "+s.hor+"-button"),t(i).not(".no-edit-button").append('<div class="bgtfw-multi-edit-button" title="Click for edit options"><div></div></div>'),t(i).not(".no-edit-button").append('<div class="bgtfw-edit-border-box"></div>'),_(n).each(function(e,o){t(i).not(".no-edit-button").find(".bgtfw-multi-edit-button").find("div").append(`\n\t\t\t\t\t<p class="bgtfw-edit-item" data-focus-type="${e.type}" data-focus-id="${o}" data-dialog-selector="${e.dialogSelector}">\n\t\t\t\t\t\t<span class="edit-label">${e.label}</span>${e.description}\n\t\t\t\t\t</p>\n\t\t\t\t`)}),t(i).find(".bgtfw-multi-edit-button").off("click").on("click",function(o){o.preventDefault(),o.stopPropagation(),t(this).toggleClass("expanded"),t(this).parent().toggleClass("expanded"),t(".bgtfw-multi-edit-button").not(this).removeClass("expanded"),t(".bgtfw-multi-edit-button, .bgtfw-edit-button").not(this).toggleClass("hidden"),t(this).parent().hasClass("expanded")&&e.fixMultiCollisions(t(this).children("div"))}),t(i).find(".bgtfw-edit-item").off("click").on("click",function(i){var n=t(this).data("focus-id"),s=t(this).data("focus-type"),a=t(this).data("dialog-selector");i.preventDefault(),i.stopPropagation(),"external"===s?e.showExternalPrompt(n,a):o[s](n).focus({completeCallback:function(){"control"===s&&o.control(n).container.fadeTo("400","0.1",function(){t(this).fadeTo("400","1")})}})})},addSingleButton:function(i,n,s,a){t(i).not(".no-"+n+"-edit-button, .no-edit-button").addClass("bgtfw-has-edit single-edit-button"),t(i).not(".no-"+n+"-edit-button, .no-edit-button").addClass(a.vert+"-button "+a.hor+"-button"),t(i).not(".no-"+n+"-edit-button, .no-edit-button").append('<div class="bgtfw-edit-button" data-focus-type="'+s.type+'" data-focus-id="'+n+'" title="'+s.label+'"><div>'),t(i).not(".no-"+n+"-edit-button, .no-edit-button").append('<div class="bgtfw-edit-border-box"></div>'),t(i).not(".no-"+n+"-edit-button, .no-edit-button").find(".bgtfw-edit-button").off("click").on("click",function(n){var a=this.dataset.focusType,d=this.dataset.focusId;"A"===t(i).not(".no-"+d+"-edit-button, .no-edit-button").prop("nodeName")&&t(i).not(".no-"+d+"-edit-button, .no-edit-button").on("click",function(t){t.preventDefault(),t.stopPropagation()}),n.preventDefault(),n.stopPropagation(),"external"===a?e.showExternalPrompt(d,s.dialogSelector):o[this.dataset.focusType](this.dataset.focusId).focus({completeCallback:function(){"control"===a&&o.control(d).container.fadeTo("700","0.1",function(){t(this).fadeTo("700","1")})}})})},showExternalPrompt:function(o,i){var n={width:400,resizable:!1,modal:!0,classes:{"ui-dialog":"bgtfw-edit-dialog"}},s=e.buttonParams.goThereNow,a=e.buttonParams[o];n.buttons={},n.buttons[s]=function(){wp.customize.preview.send("edit-post-link",a)},wp.customize.preview.bind("active",n.buttons[s]),n.buttons.cancel=function(){t(this).dialog("close")},t(i).dialog(n)}},e=BOLDGRID.CustomizerEdit}(jQuery),BOLDGRID.CustomizerEdit.init(),parent.window.BOLDGRID.CustomizerEdit=BOLDGRID.CustomizerEdit;